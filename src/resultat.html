---
layout: tunnel
title: "Publication du niveau de résultat global"
---

<h1>{{ page.title }}</h1>

<p>Le niveau de résultat est publié annuellement, au plus tard le 1er mars de
l’année en cours, au titre de l’année précédente, sur le site Internet de
l’entreprise lorsqu’il en existe un. À défaut, il est porté à la connaissance
des salariés par tout moyen.</p>

<fieldset>
  <div class=row>
    {% include input.html type="date" name="déclaration.publication.date" label="Date de publication du niveau de résultat obtenu" required=true placeholder="aaaa-mm-jj" pattern="[0-9]{4}-[0-9]{2}-[0-9]{2}" oninput="checkPatternValidity(event)" %}
  </div>
</fieldset>

<fieldset>
  <div class=row>
    <div>
      {% include radios.html
        name="_déclaration.publication.site_internet"
        label="Avez-vous un site Internet pour publier le niveau de résultat obtenu ?"
        options="oui=oui&non=non"
        onchange="toggleFields()"
        required="required" %}
    </div>
  </div>
</fieldset>

<fieldset id="fieldset-url">
  <div class=row>{% include input.html name="déclaration.publication.url" label="Adresse du site Internet de publication du niveau de résultat obtenu" required=true %}</div>
</fieldset>

<fieldset id="fieldset-modalites">
  <div class=row>{% include textarea.html name="déclaration.publication.modalités" label="Préciser les modalités de communication du niveau de résultat obtenu auprès de vos salariés" required=true %}</div>
</fieldset>

<script>
  const siteInternetField = selectField('_déclaration.publication.site_internet')

  document.onready = () => {
    if (app.getItem('déclaration.publication')) {
      // We did already submit this current form, so we can infer the
      // "_indicateurs.déclaration.publication.site_internet" data.
      if (!app.data._déclaration) app.data._déclaration = {}
      app.data._déclaration.publication = {site_internet: app.data.déclaration.publication.url ? "oui" : "non"}
    }

    // To compute the minimum publication date, we either take the
    // `déclaration.fin_période_référence` or if it's undefined, the end of
    // civil year of `déclaration.année_indicateurs`
    const endCivilYear = new Date(`${app.data.déclaration.année_indicateurs}-12-31`)
    const minPubDate = app.data.déclaration.fin_période_référence || endCivilYear.toISOString().slice(0, 10)
    // The `min` value should be formatted like yyyy-mm-dd
    selectField("déclaration.publication.date").min = minPubDate
  }

  function toggleFields() {
    const hasSiteInternetChosen = siteInternetField.querySelector(':checked')
    const hasSiteInternet = hasSiteInternetChosen && siteInternetField.querySelector(':checked').value === 'oui'
    enableField('#fieldset-url', hasSiteInternet)
    enableField('#fieldset-modalites', hasSiteInternetChosen && !hasSiteInternet)
  }

  document.onloaded = () => {
    toggleFields()
  }
</script>
